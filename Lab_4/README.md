# Lab 4
## Requirements
- a. Training details implementation
    - i. Implement Video prediction protocol in (train) stage
    - ii. Implement reparameterization tricks
    - iii. KL annealing implementation. (a) Cyclical. (b) Monotonic
- b. Teacher forcing strategy
    - i. Setup teacher forcing ratio, and plot the diagram in training
    - ii. Teacher forcing ratio: 0~1
- c. Plot diagrams
    - i. Plot the loss curve while training
    - ii. Plot PSNR-per frame diagram while validation
- d. Analysis
    - i. Compare the result in the loss curve if you apply different KL annealing strategies or even without KL annealing. Which one is better ?
- e. Validate your result and make it into gif file
    - i. Pick one video clips in testing dataset and make the frames generated by your model into a gif file (This should be shown to TAs in LAB4 demo)
- f. Derivation of Conditional VAE ( Extra point )
- i. Hand write the derivation of conditional VAE in your report
The objective function of conditional VAE is formulated as
the following. You can refer to the EM algorithm from L13
slide 23.
## Datasets
- 訓練影片和人體骨架圖
- 值得注意的是，按照助教的程式碼，訓練影片長度都是16，但測試影片都是幾百張起跳，因此很容易模型會訓練過程會不習慣預測長影片。
## Methods
- 這次的作業只有部分挖空讓我們填。
- 主要影響PSNR的部分我認為是我上述提到的長影片問題。只要讓模型可以預測長影片(也就是不要因為影片長度拉長就崩掉)，就可以輕易達到滿分標準。
- 我的作法是調低TF的比例，不要讓模型過物依賴TF，避免它學習不佳。
- 另外訓練過程中容易遇到NAN問題，不清楚怎麼解決。助教也無解，助教甚至為了這個更改評分標準。
    - 我自己測試將LR調低會稍微好一點。

## Demo
- 1.看PSNR
- 2.解釋什麼是Teacher Forcing
    - 為了避免你模型還沒訓練好以前，第一張輸出很爛，會導致後面跟著一起爛，所以讓模型一開始不要完全拿上一張的輸出當作輸入，而是可能拿Groung truth或混和之類的。
- 3.解釋KL Divergence的意義
    - 計算兩者機率分布的差，在這次作業就是計算我們的z分佈和標準高斯分布的差
- 4.解釋AE和VAE的差異
    - AE因為無法得知z空間的分佈情形，可能會不知道該如何選擇z可以得到叫好的生成結果。因此VAE讓z空間的分佈符合標準高斯分布解決這個問題。